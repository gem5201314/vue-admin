{"remainingRequest":"/Users/ibona/BL_DIY/bl@cli3_pc/node_modules/babel-loader/lib/index.js!/Users/ibona/BL_DIY/bl@cli3_pc/node_modules/eslint-loader/index.js??ref--13-0!/Users/ibona/BL_DIY/bl@cli3_pc/src/utils/http_fetch.js","dependencies":[{"path":"/Users/ibona/BL_DIY/bl@cli3_pc/src/utils/http_fetch.js","mtime":1552547846100},{"path":"/Users/ibona/BL_DIY/bl@cli3_pc/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ibona/BL_DIY/bl@cli3_pc/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/ibona/BL_DIY/bl@cli3_pc/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _JSON$stringify from \"/Users/ibona/BL_DIY/bl@cli3_pc/node_modules/@babel/runtime-corejs2/core-js/json/stringify\";\nimport _Promise from \"/Users/ibona/BL_DIY/bl@cli3_pc/node_modules/@babel/runtime-corejs2/core-js/promise\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/ibona/BL_DIY/bl@cli3_pc/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/ibona/BL_DIY/bl@cli3_pc/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/ibona/BL_DIY/bl@cli3_pc/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\n\nvar Fetch =\n/*#__PURE__*/\nfunction () {\n  function Fetch() {\n    _classCallCheck(this, Fetch);\n  }\n\n  _createClass(Fetch, null, [{\n    key: \"baseUrl\",\n    value: function baseUrl() {\n      var url = process.env.NODE_ENV === 'development' ? '/dev' : '/build';\n      return url;\n    } // 请求\n\n  }, {\n    key: \"request\",\n    value: function () {\n      var _request = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(url, methods, query) {\n        var res, data;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return fetch(this.dealRequest(url, methods, query).url, this.dealRequest(url, methods, query).data);\n\n              case 3:\n                res = _context.sent;\n                _context.next = 6;\n                return res.json();\n\n              case 6:\n                data = _context.sent;\n                _context.next = 11;\n                break;\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](0);\n\n              case 11:\n                return _context.abrupt(\"return\", new _Promise(function (resolve, reject) {\n                  if (data.code === 200) {\n                    // 数据拦截\n                    resolve(data.data);\n                  }\n\n                  if (data.code !== 200) {\n                    reject(Error, data.code); //返回错误处理...\n                  }\n                }));\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 9]]);\n      }));\n\n      function request(_x, _x2, _x3) {\n        return _request.apply(this, arguments);\n      }\n\n      return request;\n    }() //url处理\n\n  }, {\n    key: \"dealUrl\",\n    value: function dealUrl(url, methods, query) {\n      var httpUrl = this.baseUrl() + url;\n\n      if (methods === 'GET') {\n        //get方法拼接参数\n        httpUrl = this.baseUrl() + url + '?';\n\n        for (var val in query) {\n          httpUrl = \"\".concat(httpUrl).concat(val, \"=\").concat(query[val], \"&\");\n        }\n\n        httpUrl = httpUrl.substr(-1) === '&' ? httpUrl.substr(0, httpUrl.length - 1) : httpUrl;\n      }\n\n      return httpUrl;\n    } // 请求参数    \n\n  }, {\n    key: \"dealRequest\",\n    value: function dealRequest(url, methods, query) {\n      var token = 'xxxxxxxxxxx-token';\n      var data = {\n        method: methods,\n        body: methods === 'GET' ? null : _JSON$stringify(query),\n        //get方法不能有body\n        headers: new Headers({\n          'Content-Type': 'application/json',\n          'token': token,\n          'mode': 'cors'\n        })\n      };\n      return {\n        //返回url,参数\n        url: this.dealUrl(url, methods, query),\n        data: data\n      };\n    } // 请求导出 双层Promise\n\n  }, {\n    key: \"get\",\n    value: function () {\n      var _get = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2(url, data) {\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.request(url, 'GET', data);\n\n              case 2:\n                return _context2.abrupt(\"return\", _context2.sent);\n\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function get(_x4, _x5) {\n        return _get.apply(this, arguments);\n      }\n\n      return get;\n    }()\n  }, {\n    key: \"post\",\n    value: function () {\n      var _post = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3(url, data) {\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this.request(url, 'POST', data);\n\n              case 2:\n                return _context3.abrupt(\"return\", _context3.sent);\n\n              case 3:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function post(_x6, _x7) {\n        return _post.apply(this, arguments);\n      }\n\n      return post;\n    }()\n  }, {\n    key: \"delete\",\n    value: function () {\n      var _delete2 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee4(url, data) {\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return this.request(url, 'DELETE', data);\n\n              case 2:\n                return _context4.abrupt(\"return\", _context4.sent);\n\n              case 3:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function _delete(_x8, _x9) {\n        return _delete2.apply(this, arguments);\n      }\n\n      return _delete;\n    }()\n  }, {\n    key: \"put\",\n    value: function () {\n      var _put = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee5(url, data) {\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.next = 2;\n                return this.request(url, 'PUT', data);\n\n              case 2:\n                return _context5.abrupt(\"return\", _context5.sent);\n\n              case 3:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function put(_x10, _x11) {\n        return _put.apply(this, arguments);\n      }\n\n      return put;\n    }()\n  }]);\n\n  return Fetch;\n}();\n\nexport default Fetch;",{"version":3,"sources":["/Users/ibona/BL_DIY/bl@cli3_pc/src/utils/http_fetch.js"],"names":["Fetch","url","process","env","NODE_ENV","methods","query","fetch","dealRequest","data","res","json","resolve","reject","code","Error","httpUrl","baseUrl","val","substr","length","token","method","body","headers","Headers","dealUrl","request"],"mappings":"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","sourcesContent":["\n\nclass Fetch{\n  static baseUrl(){\n    let url=process.env.NODE_ENV==='development'?'/dev':'/build'\n    return  url\n  }\n  // 请求\n  static async request(url,methods,query){\n    let res,data\n    try {\n       res=await fetch(this.dealRequest(url,methods,query).url,this.dealRequest(url,methods,query).data)\n       data=await res.json()\n    } catch (error) {\n      //请求错误...\n    }\n    return new Promise((resolve,reject)=>{\n      if(data.code===200){\n        // 数据拦截\n        resolve(data.data)\n      }\n      if(data.code!==200){\n        reject(Error,data.code)\n         //返回错误处理...\n      }\n    })\n  }\n  //url处理\n  static dealUrl(url,methods,query){\n    let httpUrl=this.baseUrl()+url\n    if(methods==='GET'){ //get方法拼接参数\n      httpUrl=this.baseUrl()+url+'?'\n      for (let val in query){\n        httpUrl=`${httpUrl}${val}=${query[val]}&`\n      }\n      httpUrl=httpUrl.substr(-1)==='&'?httpUrl.substr(0,httpUrl.length-1):httpUrl\n    }\n    return httpUrl\n  }\n  // 请求参数    \n  static dealRequest(url,methods,query){\n    let token='xxxxxxxxxxx-token'\n    let data={\n      method: methods, \n      body: methods==='GET'?null:JSON.stringify(query), //get方法不能有body\n      headers: new Headers({\n        'Content-Type': 'application/json',\n        'token':token,\n        'mode': 'cors',\n      })\n    }\n    return {//返回url,参数\n      url:this.dealUrl(url,methods,query),\n      data\n    }\n  }\n\n  // 请求导出 双层Promise\n  static async get(url,data){\n    return await this.request(url,'GET',data)\n  }\n  static async post(url,data){\n    return await this.request(url,'POST',data)\n  }\n  static async delete(url,data){\n    return await this.request(url,'DELETE',data)\n  }\n  static async put(url,data){\n    return await this.request(url,'PUT',data)\n  }\n\n}\nexport default Fetch"]}]}